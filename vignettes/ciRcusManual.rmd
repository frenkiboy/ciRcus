---
title: "ciRcus"
author: "Petar Glazar, Vedran Franke"
date: "`r Sys.Date()`"
vignette: >
  %\VignetteIndexEntry{Transcription factor binding site (TFBS) analysis with the "TFBSTools" package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
output: 
  BiocStyle::html_document
---

# Introduction

ciRcus is a package for easy summarization, exploration, and annotation of 
circ RNAs detected in multiple experiments.


# Installation

# Circ RNA detection



# Summarize detected Circ RNAs

```{r library, eval=FALSE, echo=TRUE}
library(ciRcus)
```

The central function in \code{ciRcus} is the  \code{summarizeCircs} function.
The function takes as input a data.frame which contains minimally 2 columns:
1. sample - sample designation for each file
2. filename - a path to the detected Circ RNAs.

Alternatively, the user can specify supply to the function just the paths
to the files, and the coldata will be constructed automatically.

Firstly, we load the files containing find circ output
```{r Load_Data, eval=FALSE, echo=TRUE}
circ.files = list.files(system.file('extdata', package='ciRcus'),
                          pattern='sites.bed',
                          full.names=TRUE)
circ.files = circ.files[!grepl('Sy5y', circ.files)]
```

Then we merge the resulting circ RNAs into single single set of ranges.
```{r Summarize_Circs, eval=FALSE, echo=TRUE}

circs = summarizeCircs(circ.files, suffix='_rep.+')

colData(circs)

```

# Annotate Circs
```{r Annotate_Circs, eval=FALSE, echo=TRUE}
annot.file = system.file('extdata/hsa_ens75_minimal.sqlite', package='ciRcus')
annot.list = suppressMessages(loadAnnotation(annot.file))

circs = annotateCircs(circs, annot.list)

rowRanges(circs)

```



# Explore results

## Sample statistics


## Circ statistics
```{r annotPie, eval=FALSE, echo=TRUE}
annotPie(circs)
```


```{r histogram, eval=FALSE, echo=TRUE}
histogram(circs)
```


# Access to CircBase


# Constructing custom annotation

To construct a custom annotation package use the \code{gtf2sqlite} function.
The file downloads the annotation for the corresponding genome from Bioconductor
annotation hub and saves it for future use.
Curretly supported genome assemblies are: hg19,hg38,mm10,rn5,dm6

```{r histogram, eval=FALSE, echo=TRUE}
gtf2sqlite(assembly = "hg19", db.file="~/human_hg19_ens75_txdb.sqlite")
```

To load the annotation do the following:
```{r histogram, eval=FALSE, echo=TRUE}
annot.list = loadAnnotation(assembly = "hg19", db.file="~/human_hg19_ens75_txdb.sqlite")
```



